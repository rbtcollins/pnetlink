use pnet_macros_support::types::*;

#[packet]
pub struct Netlink {
    length: u32le,
    kind: u16le, // NOOP | ERROR | DONE | OVERRUN
    flags: u16le,
    seq: u16le,
    _pad1: u16le,
    pid: u32le,
    #[payload]
    #[length_fn = "payload_length"]
    payload: Vec<u8>,
}

fn payload_length(pkt: &NetlinkPacket) -> usize {
    pkt.get_length() as usize - 16
}
